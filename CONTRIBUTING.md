## 编写语言
![C++](https://img.shields.io/badge/c++-%2300599C.svg?style=for-the-badge&logo=c%2B%2B&logoColor=white)，![CMake](https://img.shields.io/badge/CMake-%23008FBA.svg?style=for-the-badge&logo=cmake&logoColor=white)
## 编写原则
1. 每个人选择其中一个设计模式，设想出架构图，如果走投无路请另寻设计模式并查阅资料。
2. 编写完成后将头文件，类文件，主文件抽出来上传到一个以自己负责的设计模式命名的文件夹即可，如果自己编写了cmake文件当然更好了。
3. 为每个设计模式绘制简易类图，编写简易文档说明类图。
## 分工
1. 2153294 孟璟陆 状态模式 解释器模式程序
2. 2153410刘金硕 工厂模式 迭代器模式 Fluent Interface模式
3. 2153273陈嘉瑞 观察者模式 润色与答辩
4. 2153305王佳蔚 装饰模式 享元模式
5. 2151409胡云韬 建造者模式 CI/CD
6. 2153174陈华机 外观模式 策略模式 命令模式
7. 2151765张铭宸 中介者模式 PPT
8. 2150618田鑫阳 访问者模式 原型模式 适配器模式
9. 2152810刘冲 责任链模式 解释器模式数据 对象池模式
10. 2150261葛一飞 抽象工厂模式 程序整合 Specification模式
## 资料来源
1. https://github.com/GyxPillar/TongjiUniversity_2022FallSemester_SoftwareDesignPatterns
2. https://chat.openai.com/share/26588bc6-486d-48d7-9f54-2375958e921e
3. https://www.bilibili.com/video/BV1NA4y1X7UK
## 15个设计模式
### 中介者模式
1 通过联系两家中介(瓜子二手车、汽车之家)，通过他们联系不同的供货商（特斯拉，NIO，小鹏汽车，比亚迪）进行供货。
### 责任链模式
2. 定义三种不同的原材料和负责该种原材料的供应商，通过责任链模式选择不同商家购买其对应的原料：
### 装饰模式
行车记录仪、倒车雷达和摄像头、车载导航系统、车载空气净化器。
### 观察者模式
当采购动作完成时，Purchaser会向采购的电脑公司和供货方更新信息。
### 工厂模式
交流电机在新能源汽车中扮演着重要角色，特别是在电动汽车（包括纯电动车和混合动力车）的动力传输系统中。这些电机作为动力来源，驱动车辆，代替了传统内燃机车辆中的发动机。
|电机               |描述|
|:--------| :---------:|
|异步电机（Induction Motor）|异步电机是通过在定子线圈中施加交变电压来产生旋转磁场，从而使得转子内感应电流产生转矩，驱动转子转动。它们没有永磁体，通常由定子和绕组组成。|
|同步电机（Synchronous Motor）| 同步电机的转子与旋转磁场同步运行，转子上有恒定的磁体（永磁体或者励磁线圈）。当转子转速与旋转磁场频率同步时，它们的速度相同。|
|开关磁阻电机（Switched Reluctance Motor，SRM）|开关磁阻电机利用磁阻力产生转矩，没有永磁体或者集电刷。其转子由一组铁心片组成，通过控制定子绕组通电来产生磁场变化，从而驱动转子旋转。|
|永磁混合电机（Permanent Magnet Hybrid Motor）|永磁混合电机结合了永磁同步电机和其他类型电机（如异步电机或开关磁阻电机）的特点，兼具高效率和高功率密度。通常利用永磁体作为励磁源。|

### 抽象工厂模式
车身和内饰：
-	车身框架
-	外部构件（车门、车窗、车顶）
-	内部装饰（座椅、方向盘、仪表板）

设计3个接口，对应车身与内饰的3部分，车身与内饰的总实现又是一个接口，可以选取两家厂商，比如比亚迪与大众。
### 建造者模式
整车的装配是顺序性的不能颠倒，很适合用建造者模式。
| 步骤                  | 描述                                                         |
|-----------------------|--------------------------------------------------------------|
| 焊接车身              | 使用机器人或工人将车身的金属部分焊接在一起，形成基本结构。  |
| 涂装                  | 包括底漆、面漆和清漆，以保护车身并提供外观。               |
| 组装底盘              | 安装底盘组件，包括悬挂系统、刹车系统、传动系统以及车轮和轮胎。|
| 安装发动机和变速器    | 安装车辆的动力系统，包括发动机和变速器。                   |
| 电气系统安装          | 安装电池、发电机、电子控制单元（ECU）以及车辆的电气系统。  |
| 安装车身部件          | 安装车身的外部和内部部件，如门、车窗、座椅、方向盘和仪表板等。|
| 安装车灯和信号灯      | 安装前灯、尾灯、刹车灯和转向灯等照明和信号灯系统。          |
| 测试和质量控制        | 进行一系列的测试和质量控制，确保车辆符合规格且没有缺陷。   |
| 涂装和装饰            | 进行最终的涂装和装饰，包括车辆的商标、标识和其他装饰性元素。|
| 最终组装和检查        | 进行最终的组装和检查，确保车辆的各个系统正常运行，并完成整体检查。|
| 运输                  | 完成最终装配和检查后，车辆被运输到经销商或出口。           |

### 外观模式 
| 步骤                   | 描述                                                         |
|------------------------|--------------------------------------------------------------|
| 地图数据获取          | 导航系统可能需要与地图数据提供商的API进行交互以获取实时地图数据。外观模式可以封装这些细节，提供一个简化的接口供用户调用。  |
| 实时交通信息处理      | 处理实时交通信息可能涉及到复杂的算法和数据分析。外观模式可以将这些处理过程封装在一个统一的接口中，以方便用户获取实时交通状况。|
| GPS定位               | 处理GPS定位信息可能包括硬件和软件层面的复杂性。外观模式可以提供一个简单的方法，让用户轻松获取当前位置信息。 |
| 语音导航              | 导航系统通常提供语音导航功能，这涉及到语音合成和导航指令生成等。外观模式可以将这些功能封装在一个简单的接口中，使用户可以方便地与语音导航交互。|
### 状态模式
实现功能
对于零件和整车，需要进行质检。质检前，状态为未检验；质检后，质量合格即为合格状态，质量不
合格即为不合格状态。一年质检一次。
### 访问者模式
针对不同配件或整体汽车，需要进行质量评估或功能评估。对于不同的评估，可能会有不同的测试者，以及不同的测试方法。
有10个需要测试的元素（选取几个就可以了），再来2个方法测试功能与质量。
加粗为功能，不加粗为质量。
1.	刹车系统：
-	刹车片和刹车盘的磨损情况。
-	刹车液体的水分含量。
-	刹车油管和管路的密封性。
-	ABS（防抱死系统）等辅助刹车系统的功能。
2.	悬挂系统：
-	悬挂系统的弹簧和减震器的状态。
-	悬挂系统的连接部分是否紧固。
-	车轮和轮胎的磨损情况。
3.	转向系统：
-	转向机构的灵活性。
-	车辆转向时的响声和异常振动。
-	转向系统的液压油液位和状态。
4.	发动机系统：
-	发动机的工作状态和噪音。
-	发动机油液位和质量。
-	空气滤清器和燃油滤清器的状态。
-	排气系统的排放是否符合标准。
5.	电气系统：
-	电池的电量和充电状态。
-	发电机的输出电压。
-	启动系统的可靠性。
-	灯光系统（前灯、尾灯、刹车灯、转向灯等）的正常工作。
6.	底盘和车身：
-	车身结构的完整性和刚性。
-	底盘连接部分的紧固和无松动。
-	车门、车窗的正常开合和密封性。
7.	内部设备：
-	座椅和安全带的状态。
-	空调和暖风系统的工作。
-	仪表盘的仪表和指示灯的正常工作。
-	音响系统的功能。
8.	安全装置：
-	安全气囊系统的可用性。
-	防盗系统的正常工作。
9.	环保和排放：
-	汽车尾气排放是否符合环保标准。
-	催化转化器的功能。
10.	轮胎和制动系统：
-	轮胎的胎压和磨损情况。
-	制动系统的性能，包括刹车灵敏度和刹车距离。

### 享元模式

位于上海长兴岛的江南造船厂是一家大型造船企业，承接了航母、国产大型邮轮、LNG船等的生产，它们生产的汽车运输船[AUTO ASPIRE](https://www.xindemarinenews.com/topic/chuanbojianzhao/2022/1021/42750.html)有7600车船与7800车船两种船型。

我国的汽车水运路线有以下几条：

1. 上海至重庆： 上海和重庆之间有一条长江水路运输线，通过长江运输汽车和其他货物。

2. 上海至武汉： 上海和武汉之间的长江水路运输线也是常见的。

3. 珠江三角洲至福建沿海地区： 珠江三角洲地区（如广州、深圳）与福建沿海地区（如福州、厦门）之间有一些沿海水路运输线。

4. 珠江口至海南岛： 通过珠江口的海上运输线路，连接广东省和海南岛，可用于汽车和货物的运输。

5. 长江中游至长江下游： 长江中游的城市如武汉、南昌等通过长江水路与长江下游城市如上海、南京相连，形成一条长江水路运输通道。

6. 黄河水运： 黄河流域也有一些水路运输线，连接黄河沿岸的城市。

我国的水运公司有一下几家：

1. 中国远洋运输集团有限公司（COSCO Shipping）
2. 中远汽车物流有限公司（COSCO Shipping Automotive Logistics）
3. 中国海外运输有限公司（COSCO Shipping Lines）
4. 中集车辆运输有限公司（SITC Vehicle Transport）
5. 中国长航汽运集团有限公司（China Changjiang National Shipping Group Corporation）
6. 中国远洋汽车运输有限公司（COSCO Vehicle Transportation）

其中多家隶属于COSCO集团。

> [!NOTE]
> 根据以上信息完成下述功能：
> 
> 享元模式用于实现物流车池的共享复用功能，运输汽车时，会先查看物流公司的当前路线的运输运力
是否充足，如果足够使用则直接复用已有的车船，否则再添加新的车船，避免出现不必要的资源
浪费。
### 迭代器模式
点击以下网址查看中铁特货的物流基地：
https://www.crscl.com.cn/wljd/
有18个铁路局，选择郑州圃田、武汉吴家山、西安新筑、上海闵行、柳州、广州这6个基地所在的铁路局即可。

6个基地之间如何连接可以通过查看 [中国铁路网络互联互通分析](https://www.unescap.org/sites/default/files/China's%20presentation%20Dushanbe.pdf) 获悉。

上述6个基地是一级基地，那么一级基地到二级基地的线路可以简化为星型模式，各个二级节点无法直连，包括黄渡在内的节点可以直接与总基地闵行连接。

> [!NOTE]
> 根据以上材料，完成迭代器模式：
> 
> 迭代器模式用于遍历物流网络，在不知道物流网络内部结构的情况下，利用迭代器任然可以做到对整
个物流网络的遍历。
### 策略模式
[参考问答](https://chat.openai.com/share/19b2b582-8bba-435f-9b0b-96481b5d41ec)

汽车有以下5种运输方式：
1. 公路运输
2. 铁路运输
3. 海运
4. 航空运输
5. 多式联运

以下为各因素对于每种运输方式的权重：
| 因素           | 公路运输 | 铁路运输 | 海运   | 航空运输 |
| -------------- | -------- | -------- | ------ | -------- |
| 距离           | 8        | 7        | 9      | 8        |
| 运输时间       | 7        | 6        | 5      | 9        |
| 成本           | 8        | 7        | 9      | 6        |
| 安全性         | 7        | 8        | 6      | 9        |
| 数量和规模     | 7        | 8        | 9      | 6        |

计算下来权重最高者为最推荐的运输方式。

> [!CAUTION]
> 根据以上信息完成下述功能：
> 
> 策略模式会根据执行的实时情况调整不同的执行策略。
>
> 不要参考学长项目的策略模式类图！

### 原型模式
> [!NOTE]
> BYD使用原型模式实现将同一赞助/联动活动的内容复制多份发送给不同的机构(高校/大型企业，如同济、交大)。由于赞助/联动内容存在较大较多信息，若每次
生成一份广告都从数据库调用内容信息，将极大程度地影响效率，而原型模式通过对象拷贝的方式解决了这一问题。
### 解释器模式

车架号，也称为车辆识别号（Vehicle Identification Number，简称VIN），是一个唯一的标识符，用于识别汽车。车架号通常由17个字符组成，包括数字和大写字母，没有字母I（为了避免与数字1混淆）和字母O（为了避免与数字0混淆）。
> [!IMPORTANT]
> 新能源汽车VIN的第8位通常用于指示车辆的类型。例如，字母"P"可能表示插电式混合动力（PHEV），而字母"E"可能表示电动车（EV）。
> 第9位是校验位。
> 具体的计算步骤如下：

1. 为字母赋权值： 将字母按照表中的权值赋予一个数字。通常，字母A至Z分别赋予1至26的值，不考虑字母I、O、Q。
```mathematica
A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
1 2 3 4 5 6 7 8   9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26
```
2. 分配权值： 将车架号前八位中的每一位数字乘以一个相应的权值。权值的分配通常是从左到右依次为8、7、6、5、4、3、2、10。
3. 求和： 将所有乘积的结果相加。
4. 取模： 对求和的结果取模10，得到一个余数。
5. 校验位计算： 将10减去余数，得到的结果就是第9位的校验位。

可以参考一下网址获取详细信息：
1. [维基百科](https://en.wikipedia.org/wiki/Vehicle_identification_number)
2. [懂车帝](https://www.dongchedi.com/article/6645099219684164099)
3. [ChatGPT历史记录](https://chat.openai.com/share/3e7a2b7d-b96b-442a-ad40-9cc9d36f3e52)
> [!NOTE]
> 根据以上信息完成下述功能：
> 
> 使用解释器模式，创建一个解码器，对输入的VIN编码表达式进行识别和翻译，进而获取汽车产
品的基本配置信息。
> 推荐使用JSON存储不同位的选项。
### 适配器模式
参考问答：https://chat.openai.com/share/182563f5-5e30-4cee-8623-c62e7cdc245f

整车测试阶段：

汽车的引擎控制单元负责管理引擎的燃油喷射、点火时机等控制，不同的ECU可能使用标准的OBD-II协议，也可能使用制造商特定的协议。
为了兼容不同的ECU与OBD-II接口，需要采用适配器模式。
> [!NOTE]
> 根据以上信息完成下述功能：
> 
> 使用适配器模式，将标准OBD-II信号转化为4种车辆的特定协议从而匹配进行通信，适配可能负责通信过程中物理层与数据链路层的数据转换，
> 以及不同格式数据的解析,本设计模式，具体如何实现兼容不用考虑，只需要设计全面即可。

### 命令模式
[新能源汽车的四大痛点](http://www.ragcc.com/2022/12/16/%E6%96%B0%E8%83%BD%E6%BA%90%E6%B1%BD%E8%BD%A6%E7%9A%84%E5%9B%9B%E5%A4%A7%E7%97%9B%E7%82%B9%E8%A7%A3%E5%86%B3%E4%BA%86%EF%BC%81/)

汽车的研发团队需要市场调研专员提供客户的需求，并根据需求来进行开发。
> [!NOTE]
> 根据以上信息完成下述功能：
> 抽象客户提出需求，项目经理收集需求，研发团队收到需求并拆分为多个Feature，每个Feature设置Priority与Due，并综合排序来进行
> 研发，不同的命令可以拆分为多个小目标完成，不同阶段的命令可以并行执行，可以参考CPU调度的过程。
>
> 以上命令执行的调度要求不一定都实现，但不能只实现一两个!

最后3个是[非GOF的设计模式](https://en.wikipedia.org/wiki/Software_design_pattern#Classification_and_lis：)
### 对象池模式
[汽车机器人的应用](https://www.sohu.com/a/247573904_99949265)

假设一个KUKA焊接机器人每分钟能够完成10个焊接点，每辆汽车需要100个焊接点，那么每辆汽车的焊接时间就是10分钟。

现在一个工厂有5台用于焊接的KUKA机器人。
> [!IMPORTANT]
> 根据以上信息完成下述功能：
> 将KUKA机器人放到对象池中，从而模拟很多汽车在流水化生产中焊接环节对KUKA机器人的使用（并发编程）。
> 设计要求:https://en.wikipedia.org/wiki/Object_pool_pattern

### Fluent Interface
https://en.wikipedia.org/wiki/Fluent_interface

用户在驾驶新能源汽车时，有很多参数可以设置，比如
|                | 充电模式        | 充电连接器            | 电池保存模式         | 驾驶模式            | 能量回收模式             | 充电计划                   | 电池温度管理               |
| -------------- | ----------- | -------------------- | -------------------- | ------------------ | ------------------------ | -------------------------- | -------------------------- |
| 模式       | 快充/慢充    | 具体连接器类型      | 启用/禁用            | 纯电动/混合动力    | 高/低/关闭               | 即时充电/定时充电           | 主动/被动                 |

还有一些数字参数：
- 预热/预冷设定：
用户可以设定在开始驾驶前预热或预冷车辆内部温度的时间和目标温度。
- 最大行驶速度设定：
用户可以设置车辆的最大行驶速度限制，有时用于提高电池续航表现。
- 音响和娱乐系统设置：
音量调节
共计7个枚举参数，3个数字参数。
> [!IMPORTANT]
> 参考链接：https://en.wikipedia.org/wiki/Fluent_interface
> 完成汽车模式的链式调节。

### Specification Pattern


汽车的自动驾驶系统蕴含着许多事务逻辑，例如
1. 惯性测量单元（IMU）和视觉SLAM的使用需要在GPS受限的情况与环境恶劣的情况下。
2. 报告需要在路线错误，容错与系统恢复成功后触发。
3. 系统通知、通报需要在路线错误，容错与系统恢复失败后触发。
4. 以上的以外需要异常检测->时间识别与分类为特定的事件后触发。
5. 异常检测是由传感器实时检测的，可以认为是间隔特定的时间进行监测。

详见：https://chat.openai.com/share/2e74f6f9-8478-4dc5-b4d9-cdb45c818e29
> [!IMPORTANT]
> 参考链接：https://en.wikipedia.org/wiki/Specification_pattern#
> 参考维基百科的C++代码示例，将以上的事务逻辑用逻辑运算表示出来。










